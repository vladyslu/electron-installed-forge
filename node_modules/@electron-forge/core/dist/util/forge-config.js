"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.fromBuildIdentifier = fromBuildIdentifier;
exports.forgeConfigIsValidFilePath = forgeConfigIsValidFilePath;
exports.renderConfigTemplate = renderConfigTemplate;
exports.default = void 0;
var _path = _interopRequireDefault(require("path"));
var _fsExtra = _interopRequireDefault(require("fs-extra"));
var interpret = _interopRequireWildcard(require("interpret"));
var _lodash = require("lodash");
var rechoir = _interopRequireWildcard(require("rechoir"));
var _hook = require("./hook");
var _pluginInterface = _interopRequireDefault(require("./plugin-interface"));
var _readPackageJson = require("./read-package-json");
function _interopRequireDefault(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
function _interopRequireWildcard(obj) {
    if (obj && obj.__esModule) {
        return obj;
    } else {
        var newObj = {};
        if (obj != null) {
            for(var key in obj){
                if (Object.prototype.hasOwnProperty.call(obj, key)) {
                    var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {};
                    if (desc.get || desc.set) {
                        Object.defineProperty(newObj, key, desc);
                    } else {
                        newObj[key] = obj[key];
                    }
                }
            }
        }
        newObj.default = obj;
        return newObj;
    }
}
const underscoreCase = (str)=>str.replace(/(.)([A-Z][a-z]+)/g, '$1_$2').replace(/([a-z0-9])([A-Z])/g, '$1_$2').toUpperCase()
;
/* eslint-disable @typescript-eslint/no-explicit-any */ const proxify = (buildIdentifier, proxifiedObject, envPrefix)=>{
    let newObject = {};
    if (Array.isArray(proxifiedObject)) {
        newObject = [];
    }
    for (const [key, val] of Object.entries(proxifiedObject)){
        if (typeof val === 'object' && (val.constructor === Object || val.constructor === Array) && key !== 'pluginInterface' && !(val instanceof RegExp)) {
            newObject[key] = proxify(buildIdentifier, proxifiedObject[key], `${envPrefix}_${underscoreCase(key)}`);
        } else {
            newObject[key] = proxifiedObject[key];
        }
    }
    return new Proxy(newObject, {
        get (target, name, receiver) {
            // eslint-disable-next-line no-prototype-builtins
            if (!target.hasOwnProperty(name) && typeof name === 'string') {
                const envValue = process.env[`${envPrefix}_${underscoreCase(name)}`];
                if (envValue) return envValue;
            }
            const value = Reflect.get(target, name, receiver);
            if (value && typeof value === 'object' && value.__isMagicBuildIdentifierMap) {
                const identifier = typeof buildIdentifier === 'function' ? buildIdentifier() : buildIdentifier;
                return value.map[identifier];
            }
            return value;
        },
        getOwnPropertyDescriptor (target, name) {
            const envValue = process.env[`${envPrefix}_${underscoreCase(name)}`];
            // eslint-disable-next-line no-prototype-builtins
            if (target.hasOwnProperty(name)) {
                return Reflect.getOwnPropertyDescriptor(target, name);
            }
            if (envValue) {
                return {
                    writable: true,
                    enumerable: true,
                    configurable: true,
                    value: envValue
                };
            }
            return undefined;
        }
    });
};
function fromBuildIdentifier(map) {
    return {
        map,
        __isMagicBuildIdentifierMap: true
    };
}
async function forgeConfigIsValidFilePath(dir, forgeConfig) {
    return typeof forgeConfig === 'string' && (await _fsExtra.default.pathExists(_path.default.resolve(dir, forgeConfig)) || _fsExtra.default.pathExists(_path.default.resolve(dir, `${forgeConfig}.js`)));
}
function renderConfigTemplate(dir, templateObj, obj) {
    for (const [key, value] of Object.entries(obj)){
        if (typeof value === 'object' && value !== null) {
            renderConfigTemplate(dir, templateObj, value);
        } else if (typeof value === 'string') {
            obj[key] = (0, _lodash).template(value)(templateObj);
            if (obj[key].startsWith('require:')) {
                obj[key] = require(_path.default.resolve(dir, obj[key].substr(8)));
            }
        }
    }
}
var _default = async (dir)=>{
    const packageJSON = await (0, _readPackageJson).readRawPackageJson(dir);
    let forgeConfig = packageJSON.config && packageJSON.config.forge ? packageJSON.config.forge : null;
    if (!forgeConfig) {
        for (const extension of [
            '.js',
            ...Object.keys(interpret.extensions)
        ]){
            const pathToConfig = _path.default.resolve(dir, `forge.config${extension}`);
            if (await _fsExtra.default.pathExists(pathToConfig)) {
                rechoir.prepare(interpret.extensions, pathToConfig, dir);
                forgeConfig = `forge.config${extension}`;
                break;
            }
        }
    }
    forgeConfig = forgeConfig || {};
    if (await forgeConfigIsValidFilePath(dir, forgeConfig)) {
        try {
            // eslint-disable-next-line @typescript-eslint/no-var-requires
            const loaded = require(_path.default.resolve(dir, forgeConfig));
            forgeConfig = 'default' in loaded ? loaded.default : loaded;
        } catch (err) {
            console.error(`Failed to load: ${_path.default.resolve(dir, forgeConfig)}`);
            throw err;
        }
    } else if (typeof forgeConfig !== 'object') {
        throw new Error('Expected packageJSON.config.forge to be an object or point to a requirable JS file');
    }
    const defaultForgeConfig = {
        rebuildConfig: {},
        packagerConfig: {},
        makers: [],
        publishers: [],
        plugins: []
    };
    let resolvedForgeConfig = {
        ...defaultForgeConfig,
        ...forgeConfig,
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        pluginInterface: null
    };
    const templateObj = {
        ...packageJSON,
        year: new Date().getFullYear()
    };
    renderConfigTemplate(dir, templateObj, resolvedForgeConfig);
    resolvedForgeConfig.pluginInterface = new _pluginInterface.default(dir, resolvedForgeConfig);
    resolvedForgeConfig = await (0, _hook).runMutatingHook(resolvedForgeConfig, 'resolveForgeConfig', resolvedForgeConfig);
    return proxify(resolvedForgeConfig.buildIdentifier || '', resolvedForgeConfig, 'ELECTRON_FORGE');
};
exports.default = _default;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlsL2ZvcmdlLWNvbmZpZy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcblxuaW1wb3J0IHsgRm9yZ2VDb25maWcsIFJlc29sdmVkRm9yZ2VDb25maWcgfSBmcm9tICdAZWxlY3Ryb24tZm9yZ2Uvc2hhcmVkLXR5cGVzJztcbmltcG9ydCBmcyBmcm9tICdmcy1leHRyYSc7XG5pbXBvcnQgKiBhcyBpbnRlcnByZXQgZnJvbSAnaW50ZXJwcmV0JztcbmltcG9ydCB7IHRlbXBsYXRlIH0gZnJvbSAnbG9kYXNoJztcbmltcG9ydCAqIGFzIHJlY2hvaXIgZnJvbSAncmVjaG9pcic7XG5cbmltcG9ydCB7IHJ1bk11dGF0aW5nSG9vayB9IGZyb20gJy4vaG9vayc7XG5pbXBvcnQgUGx1Z2luSW50ZXJmYWNlIGZyb20gJy4vcGx1Z2luLWludGVyZmFjZSc7XG5pbXBvcnQgeyByZWFkUmF3UGFja2FnZUpzb24gfSBmcm9tICcuL3JlYWQtcGFja2FnZS1qc29uJztcblxuY29uc3QgdW5kZXJzY29yZUNhc2UgPSAoc3RyOiBzdHJpbmcpID0+XG4gIHN0clxuICAgIC5yZXBsYWNlKC8oLikoW0EtWl1bYS16XSspL2csICckMV8kMicpXG4gICAgLnJlcGxhY2UoLyhbYS16MC05XSkoW0EtWl0pL2csICckMV8kMicpXG4gICAgLnRvVXBwZXJDYXNlKCk7XG5cbi8vIFdoeTogbmVlZHMgYWNjZXNzIHRvIE9iamVjdCBtZXRob2RzIGFuZCBhbHNvIG5lZWRzIHRvIGJlIGFibGUgdG8gbWF0Y2ggYW55IGludGVyZmFjZS5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXR5cGVzXG50eXBlIFByb3hpZWRPYmplY3QgPSBvYmplY3Q7XG5cbi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnkgKi9cbmNvbnN0IHByb3hpZnkgPSA8VCBleHRlbmRzIFByb3hpZWRPYmplY3Q+KGJ1aWxkSWRlbnRpZmllcjogc3RyaW5nIHwgKCgpID0+IHN0cmluZyksIHByb3hpZmllZE9iamVjdDogVCwgZW52UHJlZml4OiBzdHJpbmcpOiBUID0+IHtcbiAgbGV0IG5ld09iamVjdDogVCA9IHt9IGFzIGFueTtcbiAgaWYgKEFycmF5LmlzQXJyYXkocHJveGlmaWVkT2JqZWN0KSkge1xuICAgIG5ld09iamVjdCA9IFtdIGFzIGFueTtcbiAgfVxuXG4gIGZvciAoY29uc3QgW2tleSwgdmFsXSBvZiBPYmplY3QuZW50cmllcyhwcm94aWZpZWRPYmplY3QpKSB7XG4gICAgaWYgKHR5cGVvZiB2YWwgPT09ICdvYmplY3QnICYmICh2YWwuY29uc3RydWN0b3IgPT09IE9iamVjdCB8fCB2YWwuY29uc3RydWN0b3IgPT09IEFycmF5KSAmJiBrZXkgIT09ICdwbHVnaW5JbnRlcmZhY2UnICYmICEodmFsIGluc3RhbmNlb2YgUmVnRXhwKSkge1xuICAgICAgKG5ld09iamVjdCBhcyBhbnkpW2tleV0gPSBwcm94aWZ5KGJ1aWxkSWRlbnRpZmllciwgKHByb3hpZmllZE9iamVjdCBhcyBhbnkpW2tleV0sIGAke2VudlByZWZpeH1fJHt1bmRlcnNjb3JlQ2FzZShrZXkpfWApO1xuICAgIH0gZWxzZSB7XG4gICAgICAobmV3T2JqZWN0IGFzIGFueSlba2V5XSA9IChwcm94aWZpZWRPYmplY3QgYXMgYW55KVtrZXldO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBuZXcgUHJveHk8VD4obmV3T2JqZWN0LCB7XG4gICAgZ2V0KHRhcmdldCwgbmFtZSwgcmVjZWl2ZXIpIHtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wcm90b3R5cGUtYnVpbHRpbnNcbiAgICAgIGlmICghdGFyZ2V0Lmhhc093blByb3BlcnR5KG5hbWUpICYmIHR5cGVvZiBuYW1lID09PSAnc3RyaW5nJykge1xuICAgICAgICBjb25zdCBlbnZWYWx1ZSA9IHByb2Nlc3MuZW52W2Ake2VudlByZWZpeH1fJHt1bmRlcnNjb3JlQ2FzZShuYW1lKX1gXTtcbiAgICAgICAgaWYgKGVudlZhbHVlKSByZXR1cm4gZW52VmFsdWU7XG4gICAgICB9XG4gICAgICBjb25zdCB2YWx1ZSA9IFJlZmxlY3QuZ2V0KHRhcmdldCwgbmFtZSwgcmVjZWl2ZXIpO1xuXG4gICAgICBpZiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZS5fX2lzTWFnaWNCdWlsZElkZW50aWZpZXJNYXApIHtcbiAgICAgICAgY29uc3QgaWRlbnRpZmllciA9IHR5cGVvZiBidWlsZElkZW50aWZpZXIgPT09ICdmdW5jdGlvbicgPyBidWlsZElkZW50aWZpZXIoKSA6IGJ1aWxkSWRlbnRpZmllcjtcbiAgICAgICAgcmV0dXJuIHZhbHVlLm1hcFtpZGVudGlmaWVyXTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9LFxuICAgIGdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIG5hbWUpIHtcbiAgICAgIGNvbnN0IGVudlZhbHVlID0gcHJvY2Vzcy5lbnZbYCR7ZW52UHJlZml4fV8ke3VuZGVyc2NvcmVDYXNlKG5hbWUgYXMgc3RyaW5nKX1gXTtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1wcm90b3R5cGUtYnVpbHRpbnNcbiAgICAgIGlmICh0YXJnZXQuaGFzT3duUHJvcGVydHkobmFtZSkpIHtcbiAgICAgICAgcmV0dXJuIFJlZmxlY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwgbmFtZSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChlbnZWYWx1ZSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgIHZhbHVlOiBlbnZWYWx1ZSxcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9LFxuICB9KTtcbn07XG4vKiBlc2xpbnQtZW5hYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnkgKi9cblxuZXhwb3J0IHR5cGUgQnVpbGRJZGVudGlmaWVyTWFwPFQ+ID0gUmVjb3JkPHN0cmluZywgVCB8IHVuZGVmaW5lZD47XG5leHBvcnQgdHlwZSBCdWlsZElkZW50aWZpZXJDb25maWc8VD4gPSB7XG4gIG1hcDogQnVpbGRJZGVudGlmaWVyTWFwPFQ+O1xuICBfX2lzTWFnaWNCdWlsZElkZW50aWZpZXJNYXA6IHRydWU7XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gZnJvbUJ1aWxkSWRlbnRpZmllcjxUPihtYXA6IEJ1aWxkSWRlbnRpZmllck1hcDxUPik6IEJ1aWxkSWRlbnRpZmllckNvbmZpZzxUPiB7XG4gIHJldHVybiB7XG4gICAgbWFwLFxuICAgIF9faXNNYWdpY0J1aWxkSWRlbnRpZmllck1hcDogdHJ1ZSxcbiAgfTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZvcmdlQ29uZmlnSXNWYWxpZEZpbGVQYXRoKGRpcjogc3RyaW5nLCBmb3JnZUNvbmZpZzogc3RyaW5nIHwgRm9yZ2VDb25maWcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgcmV0dXJuIHR5cGVvZiBmb3JnZUNvbmZpZyA9PT0gJ3N0cmluZycgJiYgKChhd2FpdCBmcy5wYXRoRXhpc3RzKHBhdGgucmVzb2x2ZShkaXIsIGZvcmdlQ29uZmlnKSkpIHx8IGZzLnBhdGhFeGlzdHMocGF0aC5yZXNvbHZlKGRpciwgYCR7Zm9yZ2VDb25maWd9LmpzYCkpKTtcbn1cblxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbmV4cG9ydCBmdW5jdGlvbiByZW5kZXJDb25maWdUZW1wbGF0ZShkaXI6IHN0cmluZywgdGVtcGxhdGVPYmo6IGFueSwgb2JqOiBhbnkpOiB2b2lkIHtcbiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMob2JqKSkge1xuICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICE9PSBudWxsKSB7XG4gICAgICByZW5kZXJDb25maWdUZW1wbGF0ZShkaXIsIHRlbXBsYXRlT2JqLCB2YWx1ZSk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICBvYmpba2V5XSA9IHRlbXBsYXRlKHZhbHVlKSh0ZW1wbGF0ZU9iaik7XG4gICAgICBpZiAob2JqW2tleV0uc3RhcnRzV2l0aCgncmVxdWlyZTonKSkge1xuICAgICAgICBvYmpba2V5XSA9IHJlcXVpcmUocGF0aC5yZXNvbHZlKGRpciwgb2JqW2tleV0uc3Vic3RyKDgpKSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbnR5cGUgTWF5YmVFU008VD4gPSBUIHwgeyBkZWZhdWx0OiBUIH07XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIChkaXI6IHN0cmluZyk6IFByb21pc2U8UmVzb2x2ZWRGb3JnZUNvbmZpZz4gPT4ge1xuICBjb25zdCBwYWNrYWdlSlNPTiA9IGF3YWl0IHJlYWRSYXdQYWNrYWdlSnNvbihkaXIpO1xuICBsZXQgZm9yZ2VDb25maWc6IEZvcmdlQ29uZmlnIHwgc3RyaW5nIHwgbnVsbCA9IHBhY2thZ2VKU09OLmNvbmZpZyAmJiBwYWNrYWdlSlNPTi5jb25maWcuZm9yZ2UgPyBwYWNrYWdlSlNPTi5jb25maWcuZm9yZ2UgOiBudWxsO1xuXG4gIGlmICghZm9yZ2VDb25maWcpIHtcbiAgICBmb3IgKGNvbnN0IGV4dGVuc2lvbiBvZiBbJy5qcycsIC4uLk9iamVjdC5rZXlzKGludGVycHJldC5leHRlbnNpb25zKV0pIHtcbiAgICAgIGNvbnN0IHBhdGhUb0NvbmZpZyA9IHBhdGgucmVzb2x2ZShkaXIsIGBmb3JnZS5jb25maWcke2V4dGVuc2lvbn1gKTtcbiAgICAgIGlmIChhd2FpdCBmcy5wYXRoRXhpc3RzKHBhdGhUb0NvbmZpZykpIHtcbiAgICAgICAgcmVjaG9pci5wcmVwYXJlKGludGVycHJldC5leHRlbnNpb25zLCBwYXRoVG9Db25maWcsIGRpcik7XG4gICAgICAgIGZvcmdlQ29uZmlnID0gYGZvcmdlLmNvbmZpZyR7ZXh0ZW5zaW9ufWA7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBmb3JnZUNvbmZpZyA9IGZvcmdlQ29uZmlnIHx8ICh7fSBhcyBGb3JnZUNvbmZpZyk7XG5cbiAgaWYgKGF3YWl0IGZvcmdlQ29uZmlnSXNWYWxpZEZpbGVQYXRoKGRpciwgZm9yZ2VDb25maWcpKSB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdmFyLXJlcXVpcmVzXG4gICAgICBjb25zdCBsb2FkZWQgPSByZXF1aXJlKHBhdGgucmVzb2x2ZShkaXIsIGZvcmdlQ29uZmlnIGFzIHN0cmluZykpIGFzIE1heWJlRVNNPEZvcmdlQ29uZmlnPjtcbiAgICAgIGZvcmdlQ29uZmlnID0gJ2RlZmF1bHQnIGluIGxvYWRlZCA/IGxvYWRlZC5kZWZhdWx0IDogbG9hZGVkO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgY29uc29sZS5lcnJvcihgRmFpbGVkIHRvIGxvYWQ6ICR7cGF0aC5yZXNvbHZlKGRpciwgZm9yZ2VDb25maWcgYXMgc3RyaW5nKX1gKTtcbiAgICAgIHRocm93IGVycjtcbiAgICB9XG4gIH0gZWxzZSBpZiAodHlwZW9mIGZvcmdlQ29uZmlnICE9PSAnb2JqZWN0Jykge1xuICAgIHRocm93IG5ldyBFcnJvcignRXhwZWN0ZWQgcGFja2FnZUpTT04uY29uZmlnLmZvcmdlIHRvIGJlIGFuIG9iamVjdCBvciBwb2ludCB0byBhIHJlcXVpcmFibGUgSlMgZmlsZScpO1xuICB9XG4gIGNvbnN0IGRlZmF1bHRGb3JnZUNvbmZpZyA9IHtcbiAgICByZWJ1aWxkQ29uZmlnOiB7fSxcbiAgICBwYWNrYWdlckNvbmZpZzoge30sXG4gICAgbWFrZXJzOiBbXSxcbiAgICBwdWJsaXNoZXJzOiBbXSxcbiAgICBwbHVnaW5zOiBbXSxcbiAgfTtcbiAgbGV0IHJlc29sdmVkRm9yZ2VDb25maWc6IFJlc29sdmVkRm9yZ2VDb25maWcgPSB7XG4gICAgLi4uZGVmYXVsdEZvcmdlQ29uZmlnLFxuICAgIC4uLmZvcmdlQ29uZmlnLFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgcGx1Z2luSW50ZXJmYWNlOiBudWxsIGFzIGFueSxcbiAgfTtcblxuICBjb25zdCB0ZW1wbGF0ZU9iaiA9IHsgLi4ucGFja2FnZUpTT04sIHllYXI6IG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKSB9O1xuICByZW5kZXJDb25maWdUZW1wbGF0ZShkaXIsIHRlbXBsYXRlT2JqLCByZXNvbHZlZEZvcmdlQ29uZmlnKTtcblxuICByZXNvbHZlZEZvcmdlQ29uZmlnLnBsdWdpbkludGVyZmFjZSA9IG5ldyBQbHVnaW5JbnRlcmZhY2UoZGlyLCByZXNvbHZlZEZvcmdlQ29uZmlnKTtcblxuICByZXNvbHZlZEZvcmdlQ29uZmlnID0gYXdhaXQgcnVuTXV0YXRpbmdIb29rKHJlc29sdmVkRm9yZ2VDb25maWcsICdyZXNvbHZlRm9yZ2VDb25maWcnLCByZXNvbHZlZEZvcmdlQ29uZmlnKTtcblxuICByZXR1cm4gcHJveGlmeTxSZXNvbHZlZEZvcmdlQ29uZmlnPihyZXNvbHZlZEZvcmdlQ29uZmlnLmJ1aWxkSWRlbnRpZmllciB8fCAnJywgcmVzb2x2ZWRGb3JnZUNvbmZpZywgJ0VMRUNUUk9OX0ZPUkdFJyk7XG59O1xuIl0sIm5hbWVzIjpbImZyb21CdWlsZElkZW50aWZpZXIiLCJmb3JnZUNvbmZpZ0lzVmFsaWRGaWxlUGF0aCIsInJlbmRlckNvbmZpZ1RlbXBsYXRlIiwiaW50ZXJwcmV0IiwicmVjaG9pciIsInVuZGVyc2NvcmVDYXNlIiwic3RyIiwicmVwbGFjZSIsInRvVXBwZXJDYXNlIiwicHJveGlmeSIsImJ1aWxkSWRlbnRpZmllciIsInByb3hpZmllZE9iamVjdCIsImVudlByZWZpeCIsIm5ld09iamVjdCIsIkFycmF5IiwiaXNBcnJheSIsImtleSIsInZhbCIsIk9iamVjdCIsImVudHJpZXMiLCJjb25zdHJ1Y3RvciIsIlJlZ0V4cCIsIlByb3h5IiwiZ2V0IiwidGFyZ2V0IiwibmFtZSIsInJlY2VpdmVyIiwiaGFzT3duUHJvcGVydHkiLCJlbnZWYWx1ZSIsInByb2Nlc3MiLCJlbnYiLCJ2YWx1ZSIsIlJlZmxlY3QiLCJfX2lzTWFnaWNCdWlsZElkZW50aWZpZXJNYXAiLCJpZGVudGlmaWVyIiwibWFwIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwid3JpdGFibGUiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwidW5kZWZpbmVkIiwiZGlyIiwiZm9yZ2VDb25maWciLCJmcyIsInBhdGhFeGlzdHMiLCJwYXRoIiwicmVzb2x2ZSIsInRlbXBsYXRlT2JqIiwib2JqIiwidGVtcGxhdGUiLCJzdGFydHNXaXRoIiwicmVxdWlyZSIsInN1YnN0ciIsInBhY2thZ2VKU09OIiwicmVhZFJhd1BhY2thZ2VKc29uIiwiY29uZmlnIiwiZm9yZ2UiLCJleHRlbnNpb24iLCJrZXlzIiwiZXh0ZW5zaW9ucyIsInBhdGhUb0NvbmZpZyIsInByZXBhcmUiLCJsb2FkZWQiLCJkZWZhdWx0IiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwiRXJyb3IiLCJkZWZhdWx0Rm9yZ2VDb25maWciLCJyZWJ1aWxkQ29uZmlnIiwicGFja2FnZXJDb25maWciLCJtYWtlcnMiLCJwdWJsaXNoZXJzIiwicGx1Z2lucyIsInJlc29sdmVkRm9yZ2VDb25maWciLCJwbHVnaW5JbnRlcmZhY2UiLCJ5ZWFyIiwiRGF0ZSIsImdldEZ1bGxZZWFyIiwiUGx1Z2luSW50ZXJmYWNlIiwicnVuTXV0YXRpbmdIb29rIl0sIm1hcHBpbmdzIjoiOzs7O1FBZ0ZnQkEsbUJBQW1CLEdBQW5CQSxtQkFBbUI7UUFPYkMsMEJBQTBCLEdBQTFCQSwwQkFBMEI7UUFLaENDLG9CQUFvQixHQUFwQkEsb0JBQW9COztBQTVGbkIsR0FBTSxDQUFOLEtBQU07QUFHUixHQUFVLENBQVYsUUFBVTtBQUNiQyxHQUFTLENBQVRBLFNBQVM7QUFDSSxHQUFRLENBQVIsT0FBUTtBQUNyQkMsR0FBTyxDQUFQQSxPQUFPO0FBRWEsR0FBUSxDQUFSLEtBQVE7QUFDWixHQUFvQixDQUFwQixnQkFBb0I7QUFDYixHQUFxQixDQUFyQixnQkFBcUI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUV4RCxLQUFLLENBQUNDLGNBQWMsSUFBSUMsR0FBVyxHQUNqQ0EsR0FBRyxDQUNBQyxPQUFPLHNCQUFzQixDQUFPLFFBQ3BDQSxPQUFPLHVCQUF1QixDQUFPLFFBQ3JDQyxXQUFXOztBQU1oQixFQUF1RCxBQUF2RCxtREFBdUQsQUFBdkQsRUFBdUQsQ0FDdkQsS0FBSyxDQUFDQyxPQUFPLElBQTZCQyxlQUF3QyxFQUFFQyxlQUFrQixFQUFFQyxTQUFpQixHQUFRLENBQUM7SUFDaEksR0FBRyxDQUFDQyxTQUFTLEdBQU0sQ0FBQyxDQUFDO0lBQ3JCLEVBQUUsRUFBRUMsS0FBSyxDQUFDQyxPQUFPLENBQUNKLGVBQWUsR0FBRyxDQUFDO1FBQ25DRSxTQUFTLEdBQUcsQ0FBQyxDQUFDO0lBQ2hCLENBQUM7SUFFRCxHQUFHLEVBQUUsS0FBSyxFQUFFRyxHQUFHLEVBQUVDLEdBQUcsS0FBS0MsTUFBTSxDQUFDQyxPQUFPLENBQUNSLGVBQWUsRUFBRyxDQUFDO1FBQ3pELEVBQUUsRUFBRSxNQUFNLENBQUNNLEdBQUcsS0FBSyxDQUFRLFlBQUtBLEdBQUcsQ0FBQ0csV0FBVyxLQUFLRixNQUFNLElBQUlELEdBQUcsQ0FBQ0csV0FBVyxLQUFLTixLQUFLLEtBQUtFLEdBQUcsS0FBSyxDQUFpQixzQkFBTUMsR0FBRyxZQUFZSSxNQUFNLEdBQUcsQ0FBQztZQUNqSlIsU0FBUyxDQUFTRyxHQUFHLElBQUlQLE9BQU8sQ0FBQ0MsZUFBZSxFQUFHQyxlQUFlLENBQVNLLEdBQUcsTUFBTUosU0FBUyxDQUFDLENBQUMsRUFBRVAsY0FBYyxDQUFDVyxHQUFHO1FBQ3RILENBQUMsTUFBTSxDQUFDO1lBQ0xILFNBQVMsQ0FBU0csR0FBRyxJQUFLTCxlQUFlLENBQVNLLEdBQUc7UUFDeEQsQ0FBQztJQUNILENBQUM7SUFFRCxNQUFNLENBQUMsR0FBRyxDQUFDTSxLQUFLLENBQUlULFNBQVMsRUFBRSxDQUFDO1FBQzlCVSxHQUFHLEVBQUNDLE1BQU0sRUFBRUMsSUFBSSxFQUFFQyxRQUFRLEVBQUUsQ0FBQztZQUMzQixFQUFpRCxBQUFqRCwrQ0FBaUQ7WUFDakQsRUFBRSxHQUFHRixNQUFNLENBQUNHLGNBQWMsQ0FBQ0YsSUFBSSxLQUFLLE1BQU0sQ0FBQ0EsSUFBSSxLQUFLLENBQVEsU0FBRSxDQUFDO2dCQUM3RCxLQUFLLENBQUNHLFFBQVEsR0FBR0MsT0FBTyxDQUFDQyxHQUFHLElBQUlsQixTQUFTLENBQUMsQ0FBQyxFQUFFUCxjQUFjLENBQUNvQixJQUFJO2dCQUNoRSxFQUFFLEVBQUVHLFFBQVEsRUFBRSxNQUFNLENBQUNBLFFBQVE7WUFDL0IsQ0FBQztZQUNELEtBQUssQ0FBQ0csS0FBSyxHQUFHQyxPQUFPLENBQUNULEdBQUcsQ0FBQ0MsTUFBTSxFQUFFQyxJQUFJLEVBQUVDLFFBQVE7WUFFaEQsRUFBRSxFQUFFSyxLQUFLLElBQUksTUFBTSxDQUFDQSxLQUFLLEtBQUssQ0FBUSxXQUFJQSxLQUFLLENBQUNFLDJCQUEyQixFQUFFLENBQUM7Z0JBQzVFLEtBQUssQ0FBQ0MsVUFBVSxHQUFHLE1BQU0sQ0FBQ3hCLGVBQWUsS0FBSyxDQUFVLFlBQUdBLGVBQWUsS0FBS0EsZUFBZTtnQkFDOUYsTUFBTSxDQUFDcUIsS0FBSyxDQUFDSSxHQUFHLENBQUNELFVBQVU7WUFDN0IsQ0FBQztZQUNELE1BQU0sQ0FBQ0gsS0FBSztRQUNkLENBQUM7UUFDREssd0JBQXdCLEVBQUNaLE1BQU0sRUFBRUMsSUFBSSxFQUFFLENBQUM7WUFDdEMsS0FBSyxDQUFDRyxRQUFRLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBRyxJQUFJbEIsU0FBUyxDQUFDLENBQUMsRUFBRVAsY0FBYyxDQUFDb0IsSUFBSTtZQUNoRSxFQUFpRCxBQUFqRCwrQ0FBaUQ7WUFDakQsRUFBRSxFQUFFRCxNQUFNLENBQUNHLGNBQWMsQ0FBQ0YsSUFBSSxHQUFHLENBQUM7Z0JBQ2hDLE1BQU0sQ0FBQ08sT0FBTyxDQUFDSSx3QkFBd0IsQ0FBQ1osTUFBTSxFQUFFQyxJQUFJO1lBQ3RELENBQUM7WUFFRCxFQUFFLEVBQUVHLFFBQVEsRUFBRSxDQUFDO2dCQUNiLE1BQU0sQ0FBQyxDQUFDO29CQUNOUyxRQUFRLEVBQUUsSUFBSTtvQkFDZEMsVUFBVSxFQUFFLElBQUk7b0JBQ2hCQyxZQUFZLEVBQUUsSUFBSTtvQkFDbEJSLEtBQUssRUFBRUgsUUFBUTtnQkFDakIsQ0FBQztZQUNILENBQUM7WUFFRCxNQUFNLENBQUNZLFNBQVM7UUFDbEIsQ0FBQztJQUNILENBQUM7QUFDSCxDQUFDO1NBU2V4QyxtQkFBbUIsQ0FBSW1DLEdBQTBCLEVBQTRCLENBQUM7SUFDNUYsTUFBTSxDQUFDLENBQUM7UUFDTkEsR0FBRztRQUNIRiwyQkFBMkIsRUFBRSxJQUFJO0lBQ25DLENBQUM7QUFDSCxDQUFDO2VBRXFCaEMsMEJBQTBCLENBQUN3QyxHQUFXLEVBQUVDLFdBQWlDLEVBQW9CLENBQUM7SUFDbEgsTUFBTSxDQUFDLE1BQU0sQ0FBQ0EsV0FBVyxLQUFLLENBQVEsWUFBTSxLQUFLLENBQUNDLFFBQUUsU0FBQ0MsVUFBVSxDQUFDQyxLQUFJLFNBQUNDLE9BQU8sQ0FBQ0wsR0FBRyxFQUFFQyxXQUFXLE1BQU9DLFFBQUUsU0FBQ0MsVUFBVSxDQUFDQyxLQUFJLFNBQUNDLE9BQU8sQ0FBQ0wsR0FBRyxLQUFLQyxXQUFXLENBQUMsR0FBRztBQUN4SixDQUFDO1NBR2V4QyxvQkFBb0IsQ0FBQ3VDLEdBQVcsRUFBRU0sV0FBZ0IsRUFBRUMsR0FBUSxFQUFRLENBQUM7SUFDbkYsR0FBRyxFQUFFLEtBQUssRUFBRWhDLEdBQUcsRUFBRWUsS0FBSyxLQUFLYixNQUFNLENBQUNDLE9BQU8sQ0FBQzZCLEdBQUcsRUFBRyxDQUFDO1FBQy9DLEVBQUUsRUFBRSxNQUFNLENBQUNqQixLQUFLLEtBQUssQ0FBUSxXQUFJQSxLQUFLLEtBQUssSUFBSSxFQUFFLENBQUM7WUFDaEQ3QixvQkFBb0IsQ0FBQ3VDLEdBQUcsRUFBRU0sV0FBVyxFQUFFaEIsS0FBSztRQUM5QyxDQUFDLE1BQU0sRUFBRSxFQUFFLE1BQU0sQ0FBQ0EsS0FBSyxLQUFLLENBQVEsU0FBRSxDQUFDO1lBQ3JDaUIsR0FBRyxDQUFDaEMsR0FBRyxRQUFJaUMsT0FBUSxXQUFDbEIsS0FBSyxFQUFFZ0IsV0FBVztZQUN0QyxFQUFFLEVBQUVDLEdBQUcsQ0FBQ2hDLEdBQUcsRUFBRWtDLFVBQVUsQ0FBQyxDQUFVLFlBQUcsQ0FBQztnQkFDcENGLEdBQUcsQ0FBQ2hDLEdBQUcsSUFBSW1DLE9BQU8sQ0FBQ04sS0FBSSxTQUFDQyxPQUFPLENBQUNMLEdBQUcsRUFBRU8sR0FBRyxDQUFDaEMsR0FBRyxFQUFFb0MsTUFBTSxDQUFDLENBQUM7WUFDeEQsQ0FBQztRQUNILENBQUM7SUFDSCxDQUFDO0FBQ0gsQ0FBQztzQkFJcUJYLEdBQVcsR0FBbUMsQ0FBQztJQUNuRSxLQUFLLENBQUNZLFdBQVcsR0FBRyxLQUFLLEtBQUNDLGdCQUFrQixxQkFBQ2IsR0FBRztJQUNoRCxHQUFHLENBQUNDLFdBQVcsR0FBZ0NXLFdBQVcsQ0FBQ0UsTUFBTSxJQUFJRixXQUFXLENBQUNFLE1BQU0sQ0FBQ0MsS0FBSyxHQUFHSCxXQUFXLENBQUNFLE1BQU0sQ0FBQ0MsS0FBSyxHQUFHLElBQUk7SUFFL0gsRUFBRSxHQUFHZCxXQUFXLEVBQUUsQ0FBQztRQUNqQixHQUFHLEVBQUUsS0FBSyxDQUFDZSxTQUFTLElBQUksQ0FBQztZQUFBLENBQUs7ZUFBS3ZDLE1BQU0sQ0FBQ3dDLElBQUksQ0FBQ3ZELFNBQVMsQ0FBQ3dELFVBQVU7UUFBQyxDQUFDLENBQUUsQ0FBQztZQUN0RSxLQUFLLENBQUNDLFlBQVksR0FBR2YsS0FBSSxTQUFDQyxPQUFPLENBQUNMLEdBQUcsR0FBRyxZQUFZLEVBQUVnQixTQUFTO1lBQy9ELEVBQUUsRUFBRSxLQUFLLENBQUNkLFFBQUUsU0FBQ0MsVUFBVSxDQUFDZ0IsWUFBWSxHQUFHLENBQUM7Z0JBQ3RDeEQsT0FBTyxDQUFDeUQsT0FBTyxDQUFDMUQsU0FBUyxDQUFDd0QsVUFBVSxFQUFFQyxZQUFZLEVBQUVuQixHQUFHO2dCQUN2REMsV0FBVyxJQUFJLFlBQVksRUFBRWUsU0FBUztnQkFDdEMsS0FBSztZQUNQLENBQUM7UUFDSCxDQUFDO0lBQ0gsQ0FBQztJQUNEZixXQUFXLEdBQUdBLFdBQVcsSUFBSyxDQUFDLENBQUM7SUFFaEMsRUFBRSxFQUFFLEtBQUssQ0FBQ3pDLDBCQUEwQixDQUFDd0MsR0FBRyxFQUFFQyxXQUFXLEdBQUcsQ0FBQztRQUN2RCxHQUFHLENBQUMsQ0FBQztZQUNILEVBQThELEFBQTlELDREQUE4RDtZQUM5RCxLQUFLLENBQUNvQixNQUFNLEdBQUdYLE9BQU8sQ0FBQ04sS0FBSSxTQUFDQyxPQUFPLENBQUNMLEdBQUcsRUFBRUMsV0FBVztZQUNwREEsV0FBVyxHQUFHLENBQVMsWUFBSW9CLE1BQU0sR0FBR0EsTUFBTSxDQUFDQyxPQUFPLEdBQUdELE1BQU07UUFDN0QsQ0FBQyxDQUFDLEtBQUssRUFBRUUsR0FBRyxFQUFFLENBQUM7WUFDYkMsT0FBTyxDQUFDQyxLQUFLLEVBQUUsZ0JBQWdCLEVBQUVyQixLQUFJLFNBQUNDLE9BQU8sQ0FBQ0wsR0FBRyxFQUFFQyxXQUFXO1lBQzlELEtBQUssQ0FBQ3NCLEdBQUc7UUFDWCxDQUFDO0lBQ0gsQ0FBQyxNQUFNLEVBQUUsRUFBRSxNQUFNLENBQUN0QixXQUFXLEtBQUssQ0FBUSxTQUFFLENBQUM7UUFDM0MsS0FBSyxDQUFDLEdBQUcsQ0FBQ3lCLEtBQUssQ0FBQyxDQUFvRjtJQUN0RyxDQUFDO0lBQ0QsS0FBSyxDQUFDQyxrQkFBa0IsR0FBRyxDQUFDO1FBQzFCQyxhQUFhLEVBQUUsQ0FBQyxDQUFDO1FBQ2pCQyxjQUFjLEVBQUUsQ0FBQyxDQUFDO1FBQ2xCQyxNQUFNLEVBQUUsQ0FBQyxDQUFDO1FBQ1ZDLFVBQVUsRUFBRSxDQUFDLENBQUM7UUFDZEMsT0FBTyxFQUFFLENBQUMsQ0FBQztJQUNiLENBQUM7SUFDRCxHQUFHLENBQUNDLG1CQUFtQixHQUF3QixDQUFDO1dBQzNDTixrQkFBa0I7V0FDbEIxQixXQUFXO1FBQ2QsRUFBOEQsQUFBOUQsNERBQThEO1FBQzlEaUMsZUFBZSxFQUFFLElBQUk7SUFDdkIsQ0FBQztJQUVELEtBQUssQ0FBQzVCLFdBQVcsR0FBRyxDQUFDO1dBQUlNLFdBQVc7UUFBRXVCLElBQUksRUFBRSxHQUFHLENBQUNDLElBQUksR0FBR0MsV0FBVztJQUFHLENBQUM7SUFDdEU1RSxvQkFBb0IsQ0FBQ3VDLEdBQUcsRUFBRU0sV0FBVyxFQUFFMkIsbUJBQW1CO0lBRTFEQSxtQkFBbUIsQ0FBQ0MsZUFBZSxHQUFHLEdBQUcsQ0FBQ0ksZ0JBQWUsU0FBQ3RDLEdBQUcsRUFBRWlDLG1CQUFtQjtJQUVsRkEsbUJBQW1CLEdBQUcsS0FBSyxLQUFDTSxLQUFlLGtCQUFDTixtQkFBbUIsRUFBRSxDQUFvQixxQkFBRUEsbUJBQW1CO0lBRTFHLE1BQU0sQ0FBQ2pFLE9BQU8sQ0FBc0JpRSxtQkFBbUIsQ0FBQ2hFLGVBQWUsSUFBSSxDQUFFLEdBQUVnRSxtQkFBbUIsRUFBRSxDQUFnQjtBQUN0SCxDQUFDIn0=