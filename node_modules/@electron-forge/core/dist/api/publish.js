"use strict";
Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.default = void 0;
var _path = _interopRequireDefault(require("path"));
var _chalk = _interopRequireDefault(require("chalk"));
var _debug = _interopRequireDefault(require("debug"));
var _fsExtra = _interopRequireDefault(require("fs-extra"));
var _listr2 = require("listr2");
var _forgeConfig = _interopRequireDefault(require("../util/forge-config"));
var _outDir = _interopRequireDefault(require("../util/out-dir"));
var _publishState = _interopRequireDefault(require("../util/publish-state"));
var _requireSearch = _interopRequireDefault(require("../util/require-search"));
var _resolveDir = _interopRequireDefault(require("../util/resolve-dir"));
var _make = require("./make");
function _interopRequireDefault(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
const d = (0, _debug).default('electron-forge:publish');
const publish = async ({ dir: providedDir = process.cwd() , interactive =false , makeOptions ={} , publishTargets =undefined , dryRun =false , dryRunResume =false , outDir  })=>{
    if (dryRun && dryRunResume) {
        throw new Error("Can't dry run and resume a dry run at the same time");
    }
    const listrOptions = {
        concurrent: false,
        rendererOptions: {
            collapseErrors: false
        },
        rendererSilent: !interactive,
        rendererFallback: Boolean(process.env.DEBUG && process.env.DEBUG.includes('electron-forge'))
    };
    const publishDistributablesTasks = [
        {
            title: 'Publishing distributables',
            task: async ({ dir , forgeConfig , makeResults , publishers  }, task1)=>{
                if (publishers.length === 0) {
                    task1.output = 'No publishers configured';
                    task1.skip();
                    return;
                }
                return task1.newListr(publishers.map((publisher)=>({
                        title: `${_chalk.default.cyan(`[publisher-${publisher.name}]`)} Running the ${_chalk.default.yellow('publish')} command`,
                        task: async (_, task)=>{
                            const setStatusLine = (s)=>{
                                task.output = s;
                            };
                            await publisher.publish({
                                dir,
                                makeResults: makeResults,
                                forgeConfig,
                                setStatusLine
                            });
                        },
                        options: {
                            persistentOutput: true
                        }
                    })
                ), {
                    rendererOptions: {
                        collapse: false,
                        collapseErrors: false
                    }
                });
            },
            options: {
                persistentOutput: true
            }
        }, 
    ];
    const runner = new _listr2.Listr([
        {
            title: 'Loading configuration',
            task: async (ctx)=>{
                const resolvedDir = await (0, _resolveDir).default(providedDir);
                if (!resolvedDir) {
                    throw new Error('Failed to locate publishable Electron application');
                }
                ctx.dir = resolvedDir;
                ctx.forgeConfig = await (0, _forgeConfig).default(resolvedDir);
            }
        },
        {
            title: 'Resolving publish targets',
            task: async (ctx, task)=>{
                const { dir , forgeConfig  } = ctx;
                if (!publishTargets) {
                    publishTargets = forgeConfig.publishers || [];
                }
                publishTargets = publishTargets.map((target)=>{
                    if (typeof target === 'string') {
                        return (forgeConfig.publishers || []).find((p)=>{
                            if (typeof p === 'string') return false;
                            if (p.__isElectronForgePublisher) return false;
                            return p.name === target;
                        }) || {
                            name: target
                        };
                    }
                    return target;
                });
                ctx.publishers = [];
                for (const publishTarget of publishTargets){
                    // eslint-disable-next-line @typescript-eslint/no-explicit-any
                    let publisher;
                    if (publishTarget.__isElectronForgePublisher) {
                        // eslint-disable-next-line @typescript-eslint/no-explicit-any
                        publisher = publishTarget;
                    } else {
                        const resolvablePublishTarget = publishTarget;
                        // eslint-disable-next-line @typescript-eslint/no-explicit-any
                        const PublisherClass = (0, _requireSearch).default(dir, [
                            resolvablePublishTarget.name
                        ]);
                        if (!PublisherClass) {
                            throw new Error(`Could not find a publish target with the name: ${resolvablePublishTarget.name}. Make sure it's listed in the devDependencies of your package.json`);
                        }
                        publisher = new PublisherClass(resolvablePublishTarget.config || {}, resolvablePublishTarget.platforms);
                    }
                    ctx.publishers.push(publisher);
                }
                if (ctx.publishers.length) {
                    task.output = `Publishing to the following targets: ${_chalk.default.magenta(`${ctx.publishers.map((publisher)=>publisher.name
                    ).join(', ')}`)}`;
                }
            },
            options: {
                persistentOutput: true
            }
        },
        {
            title: dryRunResume ? 'Resuming from dry run...' : `Running ${_chalk.default.yellow('make')} command`,
            task: async (ctx1, task2)=>{
                const { dir , forgeConfig  } = ctx1;
                const calculatedOutDir = outDir || (0, _outDir).default(dir, forgeConfig);
                const dryRunDir = _path.default.resolve(calculatedOutDir, 'publish-dry-run');
                if (dryRunResume) {
                    d('attempting to resume from dry run');
                    const publishes = await _publishState.default.loadFromDirectory(dryRunDir, dir);
                    task2.title = `Resuming ${publishes.length} found dry runs...`;
                    return task2.newListr(publishes.map((publishStates, index)=>{
                        return {
                            title: `Publishing dry-run ${_chalk.default.blue(`#${index + 1}`)}`,
                            task: async (ctx, task)=>{
                                const restoredMakeResults = publishStates.map(({ state  })=>state
                                );
                                d('restoring publish settings from dry run');
                                for (const makeResult of restoredMakeResults){
                                    for (const makePath of makeResult.artifacts){
                                        if (!await _fsExtra.default.pathExists(makePath)) {
                                            throw new Error(`Attempted to resume a dry run but an artifact (${makePath}) could not be found`);
                                        }
                                    }
                                }
                                d('publishing for given state set');
                                return task.newListr(publishDistributablesTasks, {
                                    ctx: {
                                        ...ctx,
                                        makeResults: restoredMakeResults
                                    },
                                    rendererOptions: {
                                        collapse: false,
                                        collapseErrors: false
                                    }
                                });
                            }
                        };
                    }), {
                        rendererOptions: {
                            collapse: false,
                            collapseErrors: false
                        }
                    });
                }
                d('triggering make');
                return (0, _make).listrMake({
                    dir,
                    interactive,
                    ...makeOptions
                }, (results)=>{
                    ctx1.makeResults = results;
                });
            }
        },
        ...dryRunResume ? [] : dryRun ? [
            {
                title: 'Saving dry-run state',
                task: async ({ dir , forgeConfig , makeResults  })=>{
                    d('saving results of make in dry run state', makeResults);
                    const calculatedOutDir = outDir || (0, _outDir).default(dir, forgeConfig);
                    const dryRunDir = _path.default.resolve(calculatedOutDir, 'publish-dry-run');
                    await _fsExtra.default.remove(dryRunDir);
                    await _publishState.default.saveToDirectory(dryRunDir, makeResults, dir);
                }
            }, 
        ] : publishDistributablesTasks, 
    ], listrOptions);
    await runner.run();
};
var _default = publish;
exports.default = _default;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9hcGkvcHVibGlzaC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcblxuaW1wb3J0IHsgUHVibGlzaGVyQmFzZSB9IGZyb20gJ0BlbGVjdHJvbi1mb3JnZS9wdWJsaXNoZXItYmFzZSc7XG5pbXBvcnQge1xuICBGb3JnZUNvbmZpZ1B1Ymxpc2hlcixcbiAgRm9yZ2VMaXN0clRhc2ssXG4gIEZvcmdlTWFrZVJlc3VsdCxcbiAgSUZvcmdlUHVibGlzaGVyLFxuICBJRm9yZ2VSZXNvbHZhYmxlUHVibGlzaGVyLFxuICBSZXNvbHZlZEZvcmdlQ29uZmlnLFxuICAvLyBGb3JnZVBsYXRmb3JtLFxufSBmcm9tICdAZWxlY3Ryb24tZm9yZ2Uvc2hhcmVkLXR5cGVzJztcbmltcG9ydCBjaGFsayBmcm9tICdjaGFsayc7XG5pbXBvcnQgZGVidWcgZnJvbSAnZGVidWcnO1xuaW1wb3J0IGZzIGZyb20gJ2ZzLWV4dHJhJztcbmltcG9ydCB7IExpc3RyIH0gZnJvbSAnbGlzdHIyJztcblxuaW1wb3J0IGdldEZvcmdlQ29uZmlnIGZyb20gJy4uL3V0aWwvZm9yZ2UtY29uZmlnJztcbmltcG9ydCBnZXRDdXJyZW50T3V0RGlyIGZyb20gJy4uL3V0aWwvb3V0LWRpcic7XG5pbXBvcnQgUHVibGlzaFN0YXRlIGZyb20gJy4uL3V0aWwvcHVibGlzaC1zdGF0ZSc7XG5pbXBvcnQgcmVxdWlyZVNlYXJjaCBmcm9tICcuLi91dGlsL3JlcXVpcmUtc2VhcmNoJztcbmltcG9ydCByZXNvbHZlRGlyIGZyb20gJy4uL3V0aWwvcmVzb2x2ZS1kaXInO1xuXG5pbXBvcnQgeyBsaXN0ck1ha2UsIE1ha2VPcHRpb25zIH0gZnJvbSAnLi9tYWtlJztcblxuY29uc3QgZCA9IGRlYnVnKCdlbGVjdHJvbi1mb3JnZTpwdWJsaXNoJyk7XG5cbnR5cGUgUHVibGlzaENvbnRleHQgPSB7XG4gIGRpcjogc3RyaW5nO1xuICBmb3JnZUNvbmZpZzogUmVzb2x2ZWRGb3JnZUNvbmZpZztcbiAgcHVibGlzaGVyczogUHVibGlzaGVyQmFzZTx1bmtub3duPltdO1xuICBtYWtlUmVzdWx0czogRm9yZ2VNYWtlUmVzdWx0W107XG59O1xuXG5leHBvcnQgaW50ZXJmYWNlIFB1Ymxpc2hPcHRpb25zIHtcbiAgLyoqXG4gICAqIFRoZSBwYXRoIHRvIHRoZSBhcHAgdG8gYmUgcHVibGlzaGVkXG4gICAqL1xuICBkaXI/OiBzdHJpbmc7XG4gIC8qKlxuICAgKiBXaGV0aGVyIHRvIHVzZSBzZW5zaWJsZSBkZWZhdWx0cyBvciBwcm9tcHQgdGhlIHVzZXIgdmlzdWFsbHlcbiAgICovXG4gIGludGVyYWN0aXZlPzogYm9vbGVhbjtcbiAgLyoqXG4gICAqIFRoZSBwdWJsaXNoIHRhcmdldHMsIGJ5IGRlZmF1bHQgcHVsbGVkIGZyb20gZm9yZ2UgY29uZmlnLCBzZXQgdGhpcyBwcm9wIHRvXG4gICAqIG92ZXJyaWRlIHRoYXQgbGlzdFxuICAgKi9cbiAgcHVibGlzaFRhcmdldHM/OiBGb3JnZUNvbmZpZ1B1Ymxpc2hlcltdIHwgc3RyaW5nW107XG4gIC8qKlxuICAgKiBPcHRpb25zIG9iamVjdCB0byBwYXNzZWQgdGhyb3VnaCB0byBtYWtlKClcbiAgICovXG4gIG1ha2VPcHRpb25zPzogTWFrZU9wdGlvbnM7XG4gIC8qKlxuICAgKiBUaGUgcGF0aCB0byB0aGUgZGlyZWN0b3J5IGNvbnRhaW5pbmcgZ2VuZXJhdGVkIGRpc3RyaWJ1dGFibGVzXG4gICAqL1xuICBvdXREaXI/OiBzdHJpbmc7XG4gIC8qKlxuICAgKiBXaGV0aGVyIHRvIGdlbmVyYXRlIGRyeSBydW4gbWV0YSBkYXRhIGJ1dCBub3QgYWN0dWFsbHkgcHVibGlzaFxuICAgKi9cbiAgZHJ5UnVuPzogYm9vbGVhbjtcbiAgLyoqXG4gICAqIFdoZXRoZXIgb3Igbm90IHRvIGF0dGVtcHQgdG8gcmVzdW1lIGEgcHJldmlvdXNseSBzYXZlZCBgZHJ5UnVuYCBhbmQgcHVibGlzaFxuICAgKlxuICAgKiBZb3UgY2FuJ3QgdXNlIHRoaXMgY29tYmluYXRpb24gYXQgdGhlIHNhbWUgdGltZSBhcyBkcnlSdW49dHJ1ZVxuICAgKi9cbiAgZHJ5UnVuUmVzdW1lPzogYm9vbGVhbjtcbn1cblxuY29uc3QgcHVibGlzaCA9IGFzeW5jICh7XG4gIGRpcjogcHJvdmlkZWREaXIgPSBwcm9jZXNzLmN3ZCgpLFxuICBpbnRlcmFjdGl2ZSA9IGZhbHNlLFxuICBtYWtlT3B0aW9ucyA9IHt9LFxuICBwdWJsaXNoVGFyZ2V0cyA9IHVuZGVmaW5lZCxcbiAgZHJ5UnVuID0gZmFsc2UsXG4gIGRyeVJ1blJlc3VtZSA9IGZhbHNlLFxuICBvdXREaXIsXG59OiBQdWJsaXNoT3B0aW9ucyk6IFByb21pc2U8dm9pZD4gPT4ge1xuICBpZiAoZHJ5UnVuICYmIGRyeVJ1blJlc3VtZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkNhbid0IGRyeSBydW4gYW5kIHJlc3VtZSBhIGRyeSBydW4gYXQgdGhlIHNhbWUgdGltZVwiKTtcbiAgfVxuXG4gIGNvbnN0IGxpc3RyT3B0aW9ucyA9IHtcbiAgICBjb25jdXJyZW50OiBmYWxzZSxcbiAgICByZW5kZXJlck9wdGlvbnM6IHtcbiAgICAgIGNvbGxhcHNlRXJyb3JzOiBmYWxzZSxcbiAgICB9LFxuICAgIHJlbmRlcmVyU2lsZW50OiAhaW50ZXJhY3RpdmUsXG4gICAgcmVuZGVyZXJGYWxsYmFjazogQm9vbGVhbihwcm9jZXNzLmVudi5ERUJVRyAmJiBwcm9jZXNzLmVudi5ERUJVRy5pbmNsdWRlcygnZWxlY3Ryb24tZm9yZ2UnKSksXG4gIH07XG5cbiAgY29uc3QgcHVibGlzaERpc3RyaWJ1dGFibGVzVGFza3MgPSBbXG4gICAge1xuICAgICAgdGl0bGU6ICdQdWJsaXNoaW5nIGRpc3RyaWJ1dGFibGVzJyxcbiAgICAgIHRhc2s6IGFzeW5jICh7IGRpciwgZm9yZ2VDb25maWcsIG1ha2VSZXN1bHRzLCBwdWJsaXNoZXJzIH06IFB1Ymxpc2hDb250ZXh0LCB0YXNrOiBGb3JnZUxpc3RyVGFzazxQdWJsaXNoQ29udGV4dD4pID0+IHtcbiAgICAgICAgaWYgKHB1Ymxpc2hlcnMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgdGFzay5vdXRwdXQgPSAnTm8gcHVibGlzaGVycyBjb25maWd1cmVkJztcbiAgICAgICAgICB0YXNrLnNraXAoKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGFzay5uZXdMaXN0cjxuZXZlcj4oXG4gICAgICAgICAgcHVibGlzaGVycy5tYXAoKHB1Ymxpc2hlcikgPT4gKHtcbiAgICAgICAgICAgIHRpdGxlOiBgJHtjaGFsay5jeWFuKGBbcHVibGlzaGVyLSR7cHVibGlzaGVyLm5hbWV9XWApfSBSdW5uaW5nIHRoZSAke2NoYWxrLnllbGxvdygncHVibGlzaCcpfSBjb21tYW5kYCxcbiAgICAgICAgICAgIHRhc2s6IGFzeW5jIChfLCB0YXNrKSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IHNldFN0YXR1c0xpbmUgPSAoczogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICAgICAgdGFzay5vdXRwdXQgPSBzO1xuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICBhd2FpdCBwdWJsaXNoZXIucHVibGlzaCh7XG4gICAgICAgICAgICAgICAgZGlyLFxuICAgICAgICAgICAgICAgIG1ha2VSZXN1bHRzOiBtYWtlUmVzdWx0cyEsXG4gICAgICAgICAgICAgICAgZm9yZ2VDb25maWcsXG4gICAgICAgICAgICAgICAgc2V0U3RhdHVzTGluZSxcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgICAgICBwZXJzaXN0ZW50T3V0cHV0OiB0cnVlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9KSksXG4gICAgICAgICAge1xuICAgICAgICAgICAgcmVuZGVyZXJPcHRpb25zOiB7XG4gICAgICAgICAgICAgIGNvbGxhcHNlOiBmYWxzZSxcbiAgICAgICAgICAgICAgY29sbGFwc2VFcnJvcnM6IGZhbHNlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICB9LFxuICAgICAgb3B0aW9uczoge1xuICAgICAgICBwZXJzaXN0ZW50T3V0cHV0OiB0cnVlLFxuICAgICAgfSxcbiAgICB9LFxuICBdO1xuXG4gIGNvbnN0IHJ1bm5lciA9IG5ldyBMaXN0cjxQdWJsaXNoQ29udGV4dD4oXG4gICAgW1xuICAgICAge1xuICAgICAgICB0aXRsZTogJ0xvYWRpbmcgY29uZmlndXJhdGlvbicsXG4gICAgICAgIHRhc2s6IGFzeW5jIChjdHgpID0+IHtcbiAgICAgICAgICBjb25zdCByZXNvbHZlZERpciA9IGF3YWl0IHJlc29sdmVEaXIocHJvdmlkZWREaXIpO1xuICAgICAgICAgIGlmICghcmVzb2x2ZWREaXIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGxvY2F0ZSBwdWJsaXNoYWJsZSBFbGVjdHJvbiBhcHBsaWNhdGlvbicpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGN0eC5kaXIgPSByZXNvbHZlZERpcjtcbiAgICAgICAgICBjdHguZm9yZ2VDb25maWcgPSBhd2FpdCBnZXRGb3JnZUNvbmZpZyhyZXNvbHZlZERpcik7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICB0aXRsZTogJ1Jlc29sdmluZyBwdWJsaXNoIHRhcmdldHMnLFxuICAgICAgICB0YXNrOiBhc3luYyAoY3R4OiBQdWJsaXNoQ29udGV4dCwgdGFzazogRm9yZ2VMaXN0clRhc2s8UHVibGlzaENvbnRleHQ+KSA9PiB7XG4gICAgICAgICAgY29uc3QgeyBkaXIsIGZvcmdlQ29uZmlnIH0gPSBjdHg7XG5cbiAgICAgICAgICBpZiAoIXB1Ymxpc2hUYXJnZXRzKSB7XG4gICAgICAgICAgICBwdWJsaXNoVGFyZ2V0cyA9IGZvcmdlQ29uZmlnLnB1Ymxpc2hlcnMgfHwgW107XG4gICAgICAgICAgfVxuICAgICAgICAgIHB1Ymxpc2hUYXJnZXRzID0gKHB1Ymxpc2hUYXJnZXRzIGFzIEZvcmdlQ29uZmlnUHVibGlzaGVyW10pLm1hcCgodGFyZ2V0KSA9PiB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHRhcmdldCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICAgICAoZm9yZ2VDb25maWcucHVibGlzaGVycyB8fCBbXSkuZmluZCgocDogRm9yZ2VDb25maWdQdWJsaXNoZXIpID0+IHtcbiAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgcCA9PT0gJ3N0cmluZycpIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgICAgICAgIGlmICgocCBhcyBJRm9yZ2VQdWJsaXNoZXIpLl9faXNFbGVjdHJvbkZvcmdlUHVibGlzaGVyKSByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gKHAgYXMgSUZvcmdlUmVzb2x2YWJsZVB1Ymxpc2hlcikubmFtZSA9PT0gdGFyZ2V0O1xuICAgICAgICAgICAgICAgIH0pIHx8IHsgbmFtZTogdGFyZ2V0IH1cbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0YXJnZXQ7XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBjdHgucHVibGlzaGVycyA9IFtdO1xuICAgICAgICAgIGZvciAoY29uc3QgcHVibGlzaFRhcmdldCBvZiBwdWJsaXNoVGFyZ2V0cykge1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgICAgIGxldCBwdWJsaXNoZXI6IFB1Ymxpc2hlckJhc2U8YW55PjtcbiAgICAgICAgICAgIGlmICgocHVibGlzaFRhcmdldCBhcyBJRm9yZ2VQdWJsaXNoZXIpLl9faXNFbGVjdHJvbkZvcmdlUHVibGlzaGVyKSB7XG4gICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgIHB1Ymxpc2hlciA9IHB1Ymxpc2hUYXJnZXQgYXMgUHVibGlzaGVyQmFzZTxhbnk+O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgY29uc3QgcmVzb2x2YWJsZVB1Ymxpc2hUYXJnZXQgPSBwdWJsaXNoVGFyZ2V0IGFzIElGb3JnZVJlc29sdmFibGVQdWJsaXNoZXI7XG4gICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgIGNvbnN0IFB1Ymxpc2hlckNsYXNzOiBhbnkgPSByZXF1aXJlU2VhcmNoKGRpciwgW3Jlc29sdmFibGVQdWJsaXNoVGFyZ2V0Lm5hbWVdKTtcbiAgICAgICAgICAgICAgaWYgKCFQdWJsaXNoZXJDbGFzcykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAgICAgICAgIGBDb3VsZCBub3QgZmluZCBhIHB1Ymxpc2ggdGFyZ2V0IHdpdGggdGhlIG5hbWU6ICR7cmVzb2x2YWJsZVB1Ymxpc2hUYXJnZXQubmFtZX0uIE1ha2Ugc3VyZSBpdCdzIGxpc3RlZCBpbiB0aGUgZGV2RGVwZW5kZW5jaWVzIG9mIHlvdXIgcGFja2FnZS5qc29uYFxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBwdWJsaXNoZXIgPSBuZXcgUHVibGlzaGVyQ2xhc3MocmVzb2x2YWJsZVB1Ymxpc2hUYXJnZXQuY29uZmlnIHx8IHt9LCByZXNvbHZhYmxlUHVibGlzaFRhcmdldC5wbGF0Zm9ybXMpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjdHgucHVibGlzaGVycy5wdXNoKHB1Ymxpc2hlcik7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKGN0eC5wdWJsaXNoZXJzLmxlbmd0aCkge1xuICAgICAgICAgICAgdGFzay5vdXRwdXQgPSBgUHVibGlzaGluZyB0byB0aGUgZm9sbG93aW5nIHRhcmdldHM6ICR7Y2hhbGsubWFnZW50YShgJHtjdHgucHVibGlzaGVycy5tYXAoKHB1Ymxpc2hlcikgPT4gcHVibGlzaGVyLm5hbWUpLmpvaW4oJywgJyl9YCl9YDtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBwZXJzaXN0ZW50T3V0cHV0OiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgdGl0bGU6IGRyeVJ1blJlc3VtZSA/ICdSZXN1bWluZyBmcm9tIGRyeSBydW4uLi4nIDogYFJ1bm5pbmcgJHtjaGFsay55ZWxsb3coJ21ha2UnKX0gY29tbWFuZGAsXG4gICAgICAgIHRhc2s6IGFzeW5jIChjdHgsIHRhc2spID0+IHtcbiAgICAgICAgICBjb25zdCB7IGRpciwgZm9yZ2VDb25maWcgfSA9IGN0eDtcbiAgICAgICAgICBjb25zdCBjYWxjdWxhdGVkT3V0RGlyID0gb3V0RGlyIHx8IGdldEN1cnJlbnRPdXREaXIoZGlyLCBmb3JnZUNvbmZpZyk7XG4gICAgICAgICAgY29uc3QgZHJ5UnVuRGlyID0gcGF0aC5yZXNvbHZlKGNhbGN1bGF0ZWRPdXREaXIsICdwdWJsaXNoLWRyeS1ydW4nKTtcblxuICAgICAgICAgIGlmIChkcnlSdW5SZXN1bWUpIHtcbiAgICAgICAgICAgIGQoJ2F0dGVtcHRpbmcgdG8gcmVzdW1lIGZyb20gZHJ5IHJ1bicpO1xuICAgICAgICAgICAgY29uc3QgcHVibGlzaGVzID0gYXdhaXQgUHVibGlzaFN0YXRlLmxvYWRGcm9tRGlyZWN0b3J5KGRyeVJ1bkRpciwgZGlyKTtcbiAgICAgICAgICAgIHRhc2sudGl0bGUgPSBgUmVzdW1pbmcgJHtwdWJsaXNoZXMubGVuZ3RofSBmb3VuZCBkcnkgcnVucy4uLmA7XG5cbiAgICAgICAgICAgIHJldHVybiB0YXNrLm5ld0xpc3RyPFB1Ymxpc2hDb250ZXh0PihcbiAgICAgICAgICAgICAgcHVibGlzaGVzLm1hcCgocHVibGlzaFN0YXRlcywgaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgdGl0bGU6IGBQdWJsaXNoaW5nIGRyeS1ydW4gJHtjaGFsay5ibHVlKGAjJHtpbmRleCArIDF9YCl9YCxcbiAgICAgICAgICAgICAgICAgIHRhc2s6IGFzeW5jIChjdHg6IFB1Ymxpc2hDb250ZXh0LCB0YXNrOiBGb3JnZUxpc3RyVGFzazxQdWJsaXNoQ29udGV4dD4pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVzdG9yZWRNYWtlUmVzdWx0cyA9IHB1Ymxpc2hTdGF0ZXMubWFwKCh7IHN0YXRlIH0pID0+IHN0YXRlKTtcbiAgICAgICAgICAgICAgICAgICAgZCgncmVzdG9yaW5nIHB1Ymxpc2ggc2V0dGluZ3MgZnJvbSBkcnkgcnVuJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBtYWtlUmVzdWx0IG9mIHJlc3RvcmVkTWFrZVJlc3VsdHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG1ha2VQYXRoIG9mIG1ha2VSZXN1bHQuYXJ0aWZhY3RzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIShhd2FpdCBmcy5wYXRoRXhpc3RzKG1ha2VQYXRoKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBBdHRlbXB0ZWQgdG8gcmVzdW1lIGEgZHJ5IHJ1biBidXQgYW4gYXJ0aWZhY3QgKCR7bWFrZVBhdGh9KSBjb3VsZCBub3QgYmUgZm91bmRgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBkKCdwdWJsaXNoaW5nIGZvciBnaXZlbiBzdGF0ZSBzZXQnKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRhc2submV3TGlzdHIocHVibGlzaERpc3RyaWJ1dGFibGVzVGFza3MsIHtcbiAgICAgICAgICAgICAgICAgICAgICBjdHg6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC4uLmN0eCxcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ha2VSZXN1bHRzOiByZXN0b3JlZE1ha2VSZXN1bHRzLFxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgcmVuZGVyZXJPcHRpb25zOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xsYXBzZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb2xsYXBzZUVycm9yczogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgcmVuZGVyZXJPcHRpb25zOiB7XG4gICAgICAgICAgICAgICAgICBjb2xsYXBzZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICBjb2xsYXBzZUVycm9yczogZmFsc2UsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBkKCd0cmlnZ2VyaW5nIG1ha2UnKTtcbiAgICAgICAgICByZXR1cm4gbGlzdHJNYWtlKFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBkaXIsXG4gICAgICAgICAgICAgIGludGVyYWN0aXZlLFxuICAgICAgICAgICAgICAuLi5tYWtlT3B0aW9ucyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAocmVzdWx0cykgPT4ge1xuICAgICAgICAgICAgICBjdHgubWFrZVJlc3VsdHMgPSByZXN1bHRzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICk7XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgICAgLi4uKGRyeVJ1blJlc3VtZVxuICAgICAgICA/IFtdXG4gICAgICAgIDogZHJ5UnVuXG4gICAgICAgID8gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB0aXRsZTogJ1NhdmluZyBkcnktcnVuIHN0YXRlJyxcbiAgICAgICAgICAgICAgdGFzazogYXN5bmMgKHsgZGlyLCBmb3JnZUNvbmZpZywgbWFrZVJlc3VsdHMgfTogUHVibGlzaENvbnRleHQpID0+IHtcbiAgICAgICAgICAgICAgICBkKCdzYXZpbmcgcmVzdWx0cyBvZiBtYWtlIGluIGRyeSBydW4gc3RhdGUnLCBtYWtlUmVzdWx0cyk7XG4gICAgICAgICAgICAgICAgY29uc3QgY2FsY3VsYXRlZE91dERpciA9IG91dERpciB8fCBnZXRDdXJyZW50T3V0RGlyKGRpciwgZm9yZ2VDb25maWcpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGRyeVJ1bkRpciA9IHBhdGgucmVzb2x2ZShjYWxjdWxhdGVkT3V0RGlyLCAncHVibGlzaC1kcnktcnVuJyk7XG5cbiAgICAgICAgICAgICAgICBhd2FpdCBmcy5yZW1vdmUoZHJ5UnVuRGlyKTtcbiAgICAgICAgICAgICAgICBhd2FpdCBQdWJsaXNoU3RhdGUuc2F2ZVRvRGlyZWN0b3J5KGRyeVJ1bkRpciwgbWFrZVJlc3VsdHMhLCBkaXIpO1xuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICBdXG4gICAgICAgIDogcHVibGlzaERpc3RyaWJ1dGFibGVzVGFza3MpLFxuICAgIF0sXG4gICAgbGlzdHJPcHRpb25zXG4gICk7XG5cbiAgYXdhaXQgcnVubmVyLnJ1bigpO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgcHVibGlzaDtcbiJdLCJuYW1lcyI6WyJkIiwiZGVidWciLCJwdWJsaXNoIiwiZGlyIiwicHJvdmlkZWREaXIiLCJwcm9jZXNzIiwiY3dkIiwiaW50ZXJhY3RpdmUiLCJtYWtlT3B0aW9ucyIsInB1Ymxpc2hUYXJnZXRzIiwidW5kZWZpbmVkIiwiZHJ5UnVuIiwiZHJ5UnVuUmVzdW1lIiwib3V0RGlyIiwiRXJyb3IiLCJsaXN0ck9wdGlvbnMiLCJjb25jdXJyZW50IiwicmVuZGVyZXJPcHRpb25zIiwiY29sbGFwc2VFcnJvcnMiLCJyZW5kZXJlclNpbGVudCIsInJlbmRlcmVyRmFsbGJhY2siLCJCb29sZWFuIiwiZW52IiwiREVCVUciLCJpbmNsdWRlcyIsInB1Ymxpc2hEaXN0cmlidXRhYmxlc1Rhc2tzIiwidGl0bGUiLCJ0YXNrIiwiZm9yZ2VDb25maWciLCJtYWtlUmVzdWx0cyIsInB1Ymxpc2hlcnMiLCJsZW5ndGgiLCJvdXRwdXQiLCJza2lwIiwibmV3TGlzdHIiLCJtYXAiLCJwdWJsaXNoZXIiLCJjaGFsayIsImN5YW4iLCJuYW1lIiwieWVsbG93IiwiXyIsInNldFN0YXR1c0xpbmUiLCJzIiwib3B0aW9ucyIsInBlcnNpc3RlbnRPdXRwdXQiLCJjb2xsYXBzZSIsInJ1bm5lciIsIkxpc3RyIiwiY3R4IiwicmVzb2x2ZWREaXIiLCJyZXNvbHZlRGlyIiwiZ2V0Rm9yZ2VDb25maWciLCJ0YXJnZXQiLCJmaW5kIiwicCIsIl9faXNFbGVjdHJvbkZvcmdlUHVibGlzaGVyIiwicHVibGlzaFRhcmdldCIsInJlc29sdmFibGVQdWJsaXNoVGFyZ2V0IiwiUHVibGlzaGVyQ2xhc3MiLCJyZXF1aXJlU2VhcmNoIiwiY29uZmlnIiwicGxhdGZvcm1zIiwicHVzaCIsIm1hZ2VudGEiLCJqb2luIiwiY2FsY3VsYXRlZE91dERpciIsImdldEN1cnJlbnRPdXREaXIiLCJkcnlSdW5EaXIiLCJwYXRoIiwicmVzb2x2ZSIsInB1Ymxpc2hlcyIsIlB1Ymxpc2hTdGF0ZSIsImxvYWRGcm9tRGlyZWN0b3J5IiwicHVibGlzaFN0YXRlcyIsImluZGV4IiwiYmx1ZSIsInJlc3RvcmVkTWFrZVJlc3VsdHMiLCJzdGF0ZSIsIm1ha2VSZXN1bHQiLCJtYWtlUGF0aCIsImFydGlmYWN0cyIsImZzIiwicGF0aEV4aXN0cyIsImxpc3RyTWFrZSIsInJlc3VsdHMiLCJyZW1vdmUiLCJzYXZlVG9EaXJlY3RvcnkiLCJydW4iXSwibWFwcGluZ3MiOiI7Ozs7O0FBQWlCLEdBQU0sQ0FBTixLQUFNO0FBWUwsR0FBTyxDQUFQLE1BQU87QUFDUCxHQUFPLENBQVAsTUFBTztBQUNWLEdBQVUsQ0FBVixRQUFVO0FBQ0gsR0FBUSxDQUFSLE9BQVE7QUFFSCxHQUFzQixDQUF0QixZQUFzQjtBQUNwQixHQUFpQixDQUFqQixPQUFpQjtBQUNyQixHQUF1QixDQUF2QixhQUF1QjtBQUN0QixHQUF3QixDQUF4QixjQUF3QjtBQUMzQixHQUFxQixDQUFyQixXQUFxQjtBQUVMLEdBQVEsQ0FBUixLQUFROzs7Ozs7QUFFL0MsS0FBSyxDQUFDQSxDQUFDLE9BQUdDLE1BQUssVUFBQyxDQUF3QjtBQTJDeEMsS0FBSyxDQUFDQyxPQUFPLFVBQVUsQ0FBQyxDQUN0QkMsR0FBRyxFQUFFQyxXQUFXLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBRyxLQUM5QkMsV0FBVyxFQUFHLEtBQUssR0FDbkJDLFdBQVcsRUFBRyxDQUFDLENBQUMsR0FDaEJDLGNBQWMsRUFBR0MsU0FBUyxHQUMxQkMsTUFBTSxFQUFHLEtBQUssR0FDZEMsWUFBWSxFQUFHLEtBQUssR0FDcEJDLE1BQU0sRUFDUSxDQUFDLEdBQW9CLENBQUM7SUFDcEMsRUFBRSxFQUFFRixNQUFNLElBQUlDLFlBQVksRUFBRSxDQUFDO1FBQzNCLEtBQUssQ0FBQyxHQUFHLENBQUNFLEtBQUssQ0FBQyxDQUFxRDtJQUN2RSxDQUFDO0lBRUQsS0FBSyxDQUFDQyxZQUFZLEdBQUcsQ0FBQztRQUNwQkMsVUFBVSxFQUFFLEtBQUs7UUFDakJDLGVBQWUsRUFBRSxDQUFDO1lBQ2hCQyxjQUFjLEVBQUUsS0FBSztRQUN2QixDQUFDO1FBQ0RDLGNBQWMsR0FBR1osV0FBVztRQUM1QmEsZ0JBQWdCLEVBQUVDLE9BQU8sQ0FBQ2hCLE9BQU8sQ0FBQ2lCLEdBQUcs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