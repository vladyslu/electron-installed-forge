"use strict";
var _path = _interopRequireDefault(require("path"));
var _core = require("@electron-forge/core");
var _get = require("@electron/get");
var _commander = _interopRequireDefault(require("commander"));
var _fsExtra = _interopRequireDefault(require("fs-extra"));
require("./util/terminate");
var _electronForgeMake = require("./electron-forge-make");
var _workingDir = _interopRequireDefault(require("./util/working-dir"));
function _interopRequireDefault(obj) {
    return obj && obj.__esModule ? obj : {
        default: obj
    };
}
(async ()=>{
    let dir = process.cwd();
    _commander.default.version((await _fsExtra.default.readJson(_path.default.resolve(__dirname, '../package.json'))).version).arguments('[cwd]').option('--target [target[,target...]]', 'The comma-separated deployment targets, defaults to "github"').option('--dry-run', "Triggers a publish dry run which saves state and doesn't upload anything").option('--from-dry-run', 'Attempts to publish artifacts from the last saved dry run').allowUnknownOption(true).action((cwd)=>{
        dir = (0, _workingDir).default(dir, cwd);
    }).parse(process.argv);
    (0, _get).initializeProxy();
    const publishOpts = {
        dir,
        interactive: true,
        dryRun: _commander.default.dryRun,
        dryRunResume: _commander.default.fromDryRun
    };
    if (_commander.default.target) publishOpts.publishTargets = _commander.default.target.split(',');
    publishOpts.makeOptions = await (0, _electronForgeMake).getMakeOptions();
    await _core.api.publish(publishOpts);
})();

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9lbGVjdHJvbi1mb3JnZS1wdWJsaXNoLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuXG5pbXBvcnQgeyBhcGksIFB1Ymxpc2hPcHRpb25zIH0gZnJvbSAnQGVsZWN0cm9uLWZvcmdlL2NvcmUnO1xuaW1wb3J0IHsgaW5pdGlhbGl6ZVByb3h5IH0gZnJvbSAnQGVsZWN0cm9uL2dldCc7XG5pbXBvcnQgcHJvZ3JhbSBmcm9tICdjb21tYW5kZXInO1xuaW1wb3J0IGZzIGZyb20gJ2ZzLWV4dHJhJztcblxuaW1wb3J0ICcuL3V0aWwvdGVybWluYXRlJztcbmltcG9ydCB7IGdldE1ha2VPcHRpb25zIH0gZnJvbSAnLi9lbGVjdHJvbi1mb3JnZS1tYWtlJztcbmltcG9ydCB3b3JraW5nRGlyIGZyb20gJy4vdXRpbC93b3JraW5nLWRpcic7XG5cbihhc3luYyAoKSA9PiB7XG4gIGxldCBkaXIgPSBwcm9jZXNzLmN3ZCgpO1xuICBwcm9ncmFtXG4gICAgLnZlcnNpb24oKGF3YWl0IGZzLnJlYWRKc29uKHBhdGgucmVzb2x2ZShfX2Rpcm5hbWUsICcuLi9wYWNrYWdlLmpzb24nKSkpLnZlcnNpb24pXG4gICAgLmFyZ3VtZW50cygnW2N3ZF0nKVxuICAgIC5vcHRpb24oJy0tdGFyZ2V0IFt0YXJnZXRbLHRhcmdldC4uLl1dJywgJ1RoZSBjb21tYS1zZXBhcmF0ZWQgZGVwbG95bWVudCB0YXJnZXRzLCBkZWZhdWx0cyB0byBcImdpdGh1YlwiJylcbiAgICAub3B0aW9uKCctLWRyeS1ydW4nLCBcIlRyaWdnZXJzIGEgcHVibGlzaCBkcnkgcnVuIHdoaWNoIHNhdmVzIHN0YXRlIGFuZCBkb2Vzbid0IHVwbG9hZCBhbnl0aGluZ1wiKVxuICAgIC5vcHRpb24oJy0tZnJvbS1kcnktcnVuJywgJ0F0dGVtcHRzIHRvIHB1Ymxpc2ggYXJ0aWZhY3RzIGZyb20gdGhlIGxhc3Qgc2F2ZWQgZHJ5IHJ1bicpXG4gICAgLmFsbG93VW5rbm93bk9wdGlvbih0cnVlKVxuICAgIC5hY3Rpb24oKGN3ZCkgPT4ge1xuICAgICAgZGlyID0gd29ya2luZ0RpcihkaXIsIGN3ZCk7XG4gICAgfSlcbiAgICAucGFyc2UocHJvY2Vzcy5hcmd2KTtcblxuICBpbml0aWFsaXplUHJveHkoKTtcblxuICBjb25zdCBwdWJsaXNoT3B0czogUHVibGlzaE9wdGlvbnMgPSB7XG4gICAgZGlyLFxuICAgIGludGVyYWN0aXZlOiB0cnVlLFxuICAgIGRyeVJ1bjogcHJvZ3JhbS5kcnlSdW4sXG4gICAgZHJ5UnVuUmVzdW1lOiBwcm9ncmFtLmZyb21EcnlSdW4sXG4gIH07XG4gIGlmIChwcm9ncmFtLnRhcmdldCkgcHVibGlzaE9wdHMucHVibGlzaFRhcmdldHMgPSBwcm9ncmFtLnRhcmdldC5zcGxpdCgnLCcpO1xuXG4gIHB1Ymxpc2hPcHRzLm1ha2VPcHRpb25zID0gYXdhaXQgZ2V0TWFrZU9wdGlvbnMoKTtcblxuICBhd2FpdCBhcGkucHVibGlzaChwdWJsaXNoT3B0cyk7XG59KSgpO1xuIl0sIm5hbWVzIjpbImRpciIsInByb2Nlc3MiLCJjd2QiLCJwcm9ncmFtIiwidmVyc2lvbiIsImZzIiwicmVhZEpzb24iLCJwYXRoIiwicmVzb2x2ZSIsIl9fZGlybmFtZSIsImFyZ3VtZW50cyIsIm9wdGlvbiIsImFsbG93VW5rbm93bk9wdGlvbiIsImFjdGlvbiIsIndvcmtpbmdEaXIiLCJwYXJzZSIsImFyZ3YiLCJpbml0aWFsaXplUHJveHkiLCJwdWJsaXNoT3B0cyIsImludGVyYWN0aXZlIiwiZHJ5UnVuIiwiZHJ5UnVuUmVzdW1lIiwiZnJvbURyeVJ1biIsInRhcmdldCIsInB1Ymxpc2hUYXJnZXRzIiwic3BsaXQiLCJtYWtlT3B0aW9ucyIsImdldE1ha2VPcHRpb25zIiwiYXBpIiwicHVibGlzaCJdLCJtYXBwaW5ncyI6IjtBQUFpQixHQUFNLENBQU4sS0FBTTtBQUVhLEdBQXNCLENBQXRCLEtBQXNCO0FBQzFCLEdBQWUsQ0FBZixJQUFlO0FBQzNCLEdBQVcsQ0FBWCxVQUFXO0FBQ2hCLEdBQVUsQ0FBVixRQUFVOztBQUdNLEdBQXVCLENBQXZCLGtCQUF1QjtBQUMvQixHQUFvQixDQUFwQixXQUFvQjs7Ozs7O1dBRTlCLENBQUM7SUFDWixHQUFHLENBQUNBLEdBQUcsR0FBR0MsT0FBTyxDQUFDQyxHQUFHO0lBQ3JCQyxVQUFPLFNBQ0pDLE9BQU8sRUFBRSxLQUFLLENBQUNDLFFBQUUsU0FBQ0MsUUFBUSxDQUFDQyxLQUFJLFNBQUNDLE9BQU8sQ0FBQ0MsU0FBUyxFQUFFLENBQWlCLG9CQUFJTCxPQUFPLEVBQy9FTSxTQUFTLENBQUMsQ0FBTyxRQUNqQkMsTUFBTSxDQUFDLENBQStCLGdDQUFFLENBQThELCtEQUN0R0EsTUFBTSxDQUFDLENBQVcsWUFBRSxDQUEwRSwyRUFDOUZBLE1BQU0sQ0FBQyxDQUFnQixpQkFBRSxDQUEyRCw0REFDcEZDLGtCQUFrQixDQUFDLElBQUksRUFDdkJDLE1BQU0sRUFBRVgsR0FBRyxHQUFLLENBQUM7UUFDaEJGLEdBQUcsT0FBR2MsV0FBVSxVQUFDZCxHQUFHLEVBQUVFLEdBQUc7SUFDM0IsQ0FBQyxFQUNBYSxLQUFLLENBQUNkLE9BQU8sQ0FBQ2UsSUFBSTtRQUVyQkMsSUFBZTtJQUVmLEtBQUssQ0FBQ0MsV0FBVyxHQUFtQixDQUFDO1FBQ25DbEIsR0FBRztRQUNIbUIsV0FBVyxFQUFFLElBQUk7UUFDakJDLE1BQU0sRUFBRWpCLFVBQU8sU0FBQ2lCLE1BQU07UUFDdEJDLFlBQVksRUFBRWxCLFVBQU8sU0FBQ21CLFVBQVU7SUFDbEMsQ0FBQztJQUNELEVBQUUsRUFBRW5CLFVBQU8sU0FBQ29CLE1BQU0sRUFBRUwsV0FBVyxDQUFDTSxjQUFjLEdBQUdyQixVQUFPLFNBQUNvQixNQUFNLENBQUNFLEtBQUssQ0FBQyxDQUFHO0lBRXpFUCxXQUFXLENBQUNRLFdBQVcsR0FBRyxLQUFLLEtBQUNDLGtCQUFjO0lBRTlDLEtBQUssQ0FBQ0MsS0FBRyxLQUFDQyxPQUFPLENBQUNYLFdBQVc7QUFDL0IsQ0FBQyJ9